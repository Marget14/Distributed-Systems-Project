<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{base}">
<head>
    <title>Browse Restaurants</title>
    <style>
        /* Efood-like styling */
        .store-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .store-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
        }
        .badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-weight: 600;
        }
        .badge-new {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .badge-featured {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        .badge-free-delivery {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        .badge-top-rated {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }
        .rating-stars {
            color: #fbbf24;
        }
        .promo-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 0.5rem;
            padding: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: white;
            font-weight: 600;
        }
        .filter-chip {
            transition: all 0.2s ease;
        }
        .filter-chip:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
<div layout:fragment="main" class="container mx-auto px-4 py-8">
    <!-- Hero Search Section -->
    <div class="glass-panel p-8 mb-8 text-center">
        <h1 class="text-4xl md:text-5xl font-orbitron font-bold text-white mb-4">
            üçï Find Your Favorite Food
        </h1>
        <p class="text-gray-300 mb-6 text-lg">Order from the best restaurants in your area</p>

        <!-- Search & Filters -->
        <form th:action="@{/stores}" method="get" class="max-w-4xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <input type="text" name="search" th:value="${searchQuery}"
                       placeholder="Search restaurants, food..."
                       class="md:col-span-2 px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyber-blue"/>

                <select name="cuisine" class="px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:border-cyber-blue">
                    <option value="">All Cuisines</option>
                    <option th:each="type : ${cuisineTypes}"
                            th:value="${type}"
                            th:text="${type}"
                            th:selected="${selectedCuisine != null and selectedCuisine == type.toString()}"></option>
                </select>

                <button type="submit" class="cyber-button">
                    <i class="fas fa-search mr-2"></i>Search
                </button>
            </div>

            <!-- Quick Filter Chips -->
            <div class="flex flex-wrap justify-center gap-3 mt-4">
                <a th:href="@{/stores}" class="filter-chip px-4 py-2 bg-white/5 hover:bg-white/10 rounded-full text-sm text-white border border-white/10">
                    üî• All Restaurants
                </a>
                <a th:href="@{/stores(area='Athens')}" class="filter-chip px-4 py-2 bg-white/5 hover:bg-white/10 rounded-full text-sm text-white border border-white/10">
                    üìç Athens Center
                </a>
                <a th:href="@{/stores(cuisine='ITALIAN')}" class="filter-chip px-4 py-2 bg-white/5 hover:bg-white/10 rounded-full text-sm text-white border border-white/10">
                    üçù Italian
                </a>
                <a th:href="@{/stores(cuisine='GREEK')}" class="filter-chip px-4 py-2 bg-white/5 hover:bg-white/10 rounded-full text-sm text-white border border-white/10">
                    ü•ô Greek
                </a>
                <a th:href="@{/stores(cuisine='ASIAN')}" class="filter-chip px-4 py-2 bg-white/5 hover:bg-white/10 rounded-full text-sm text-white border border-white/10">
                    üçú Asian
                </a>
            </div>
        </form>
    </div>

    <!-- Results Header -->
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl md:text-3xl font-orbitron font-bold text-white">
            <span th:if="${searchQuery != null and !searchQuery.isEmpty()}" th:text="'Results for: ' + ${searchQuery}">Search Results</span>
            <span th:if="${selectedCuisine != null}" th:text="${selectedCuisine} + ' Restaurants'">Cuisine Results</span>
            <span th:if="${selectedArea != null and !selectedArea.isEmpty()}" th:text="'Restaurants in ' + ${selectedArea}">Area Results</span>
            <span th:if="${searchQuery == null and selectedCuisine == null and selectedArea == null}">Open Now üç¥</span>
        </h2>
        <p class="text-gray-400">
            <span th:text="${stores != null ? stores.size() : 0}">0</span> restaurants
        </p>
    </div>

    <!-- Empty State -->
    <div th:if="${stores == null or stores.isEmpty()}" class="glass-panel p-16 text-center">
        <div class="text-8xl mb-4">üòî</div>
        <h3 class="text-2xl text-white mb-3">No restaurants found</h3>
        <p class="text-gray-400 mb-8">Try adjusting your search or explore all restaurants</p>
        <a th:href="@{/stores}" class="cyber-button inline-block text-lg px-8 py-3">
            <i class="fas fa-utensils mr-2"></i>View All Restaurants
        </a>
    </div>

    <!-- Store Grid - Efood Style -->
    <div th:if="${stores != null and !stores.isEmpty()}" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <a th:each="store : ${stores}"
           th:href="@{/stores/{id}(id=${store.id})}"
           class="glass-panel overflow-hidden store-card block">

            <!-- Store Image/Banner -->
            <div class="relative h-48 bg-gradient-to-br from-purple-500/20 to-pink-500/20">
                <img th:if="${store.imageUrl != null}"
                     th:src="${store.imageUrl}"
                     alt="Store cover"
                     class="w-full h-full object-cover"/>
                <div th:unless="${store.imageUrl != null}"
                     class="w-full h-full flex items-center justify-center text-6xl">
                    üçΩÔ∏è
                </div>

                <!-- Status Badge -->
                <div class="absolute top-3 right-3">
                    <span th:if="${store.isOpen}"
                          class="px-3 py-1.5 bg-green-500 text-white rounded-full text-xs font-bold shadow-lg">
                        ‚óè OPEN
                    </span>
                    <span th:unless="${store.isOpen}"
                          class="px-3 py-1.5 bg-red-500 text-white rounded-full text-xs font-bold shadow-lg">
                        ‚óè CLOSED
                    </span>
                </div>

                <!-- Special Badges -->
                <div class="absolute top-3 left-3 flex flex-col gap-2">
                    <span th:if="${store.isNew}" class="badge badge-new">
                        ‚ú® NEW
                    </span>
                    <span th:if="${store.isFeatured}" class="badge badge-featured">
                        ‚≠ê FEATURED
                    </span>
                    <span th:if="${store.freeDeliveryThreshold != null}" class="badge badge-free-delivery">
                        üöö FREE DELIVERY
                    </span>
                </div>
            </div>

            <!-- Store Info -->
            <div class="p-5">
                <!-- Store Name & Rating -->
                <div class="flex items-start justify-between mb-2">
                    <div class="flex-1">
                        <h3 class="text-xl font-bold text-white mb-1 line-clamp-1" th:text="${store.name}">Restaurant Name</h3>
                        <p class="text-sm text-gray-400" th:text="${store.cuisineType}">Cuisine</p>
                    </div>
                </div>

                <!-- Rating -->
                <div th:if="${store.averageRating != null and store.averageRating > 0}" class="flex items-center gap-2 mb-3">
                    <div class="rating-stars">
                        <i class="fas fa-star"></i>
                        <span class="text-white font-bold ml-1" th:text="${#numbers.formatDecimal(store.averageRating, 1, 1)}">4.5</span>
                    </div>
                    <span class="text-gray-400 text-sm">
                        (<span th:text="${store.totalReviews}">120</span> reviews)
                    </span>
                </div>

                <p class="text-gray-300 text-sm mb-4 line-clamp-2 h-10" th:text="${store.description}">Delicious food from the best chefs</p>

                <!-- Delivery Info Grid -->
                <div class="grid grid-cols-2 gap-3 text-sm mb-3">
                    <div class="flex items-center text-gray-400">
                        <i class="fas fa-clock mr-2 text-cyber-blue"></i>
                        <span th:text="${store.estimatedDeliveryTimeMinutes} + ' min'">30 min</span>
                    </div>
                    <div class="flex items-center text-gray-400">
                        <i class="fas fa-motorcycle mr-2 text-neon-pink"></i>
                        <span>‚Ç¨<span th:text="${store.deliveryFee}">2.50</span></span>
                    </div>
                    <div class="flex items-center text-gray-400">
                        <i class="fas fa-euro-sign mr-2 text-ai-orange"></i>
                        <span>Min ‚Ç¨<span th:text="${store.minimumOrderAmount}">10</span></span>
                    </div>
                    <div class="flex items-center text-gray-400">
                        <i class="fas fa-map-marker-alt mr-2 text-quantum"></i>
                        <span th:text="${store.area}">Area</span>
                    </div>
                </div>

                <!-- Service Options -->
                <div class="flex gap-2 pt-3 border-t border-white/10">
                    <span th:if="${store.acceptsDelivery}"
                          class="flex-1 text-center px-2 py-1.5 bg-cyber-blue/20 text-cyber-blue rounded text-xs font-semibold">
                        <i class="fas fa-motorcycle mr-1"></i>Delivery
                    </span>
                    <span th:if="${store.acceptsPickup}"
                          class="flex-1 text-center px-2 py-1.5 bg-quantum/20 text-quantum rounded text-xs font-semibold">
                        <i class="fas fa-shopping-bag mr-1"></i>Pickup
                    </span>
                </div>

                <!-- Promotion Banner (if applicable) -->
                <div th:if="${store.freeDeliveryThreshold != null}" class="promo-banner mt-3">
                    <i class="fas fa-gift mr-2"></i>
                    Free delivery over ‚Ç¨<span th:text="${store.freeDeliveryThreshold}">15</span>!
                </div>
            </div>
        </a>
    </div>

    <!-- Load More (if pagination implemented) -->
    <div th:if="${stores != null and stores.size() >= 12}" class="text-center mt-12">
        <button class="cyber-button text-lg px-8 py-3">
            <i class="fas fa-arrow-down mr-2"></i>Load More Restaurants
        </button>
    </div>
</div>
</body>
</html>