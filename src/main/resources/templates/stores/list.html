<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{base}">
<head><title>Browse Stores</title></head>
<body>
<div layout:fragment="main" class="container mx-auto px-4 py-8">
    <!-- Search & Filters -->
    <div class="glass-panel p-6 mb-8">
        <form th:action="@{/stores}" method="get" class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <input type="text" name="search" th:value="${searchQuery}" placeholder="Search stores..."
                   class="px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyber-blue"/>
            <select name="cuisine" class="px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:border-cyber-blue">
                <option value="">All Cuisines</option>
                <option th:each="type : ${cuisineTypes}" th:value="${type}" th:text="${type}" th:selected="${selectedCuisine == type}"></option>
            </select>
            <input type="text" name="area" th:value="${selectedArea}" placeholder="Area (e.g., Kolonaki)"
                   class="px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyber-blue"/>
            <button type="submit" class="cyber-button"><i class="fas fa-search mr-2"></i>Search</button>
        </form>
    </div>

    <!-- Results Header -->
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-3xl font-orbitron font-bold text-white">
            <span th:if="${searchQuery}" th:text="'Results for: ' + ${searchQuery}">Search Results</span>
            <span th:if="${selectedCuisine}" th:text="${selectedCuisine} + ' Restaurants'">Cuisine Results</span>
            <span th:if="${selectedArea}" th:text="'Stores in ' + ${selectedArea}">Area Results</span>
            <span th:if="${!searchQuery && !selectedCuisine && !selectedArea}">All Open Stores</span>
        </h2>
        <p class="text-gray-400"><span th:text="${#lists.size(stores)}">0</span> stores found</p>
    </div>

    <!-- Empty State -->
    <div th:if="${#lists.isEmpty(stores)}" class="glass-panel p-12 text-center">
        <i class="fas fa-search text-6xl text-gray-600 mb-4"></i>
        <h3 class="text-xl text-gray-400 mb-2">No stores found</h3>
        <p class="text-gray-500 mb-6">Try adjusting your search filters</p>
        <a th:href="@{/stores}" class="cyber-button inline-block">View All Stores</a>
    </div>

    <!-- Store Grid -->
    <div th:unless="${#lists.isEmpty(stores)}" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <a th:each="store : ${stores}" th:href="@{/stores/{id}(id=${store.id()})}" class="glass-panel p-6 store-card block">
            <div class="flex items-start justify-between mb-4">
                <div class="flex-1">
                    <h3 class="text-xl font-bold text-white mb-1" th:text="${store.name()}">Store Name</h3>
                    <p class="text-sm text-gray-400" th:text="${store.cuisineType()}">Cuisine</p>
                </div>
                <span th:if="${store.isOpen()}" class="px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-xs font-semibold">OPEN</span>
                <span th:unless="${store.isOpen()}" class="px-3 py-1 bg-red-500/20 text-red-400 rounded-full text-xs font-semibold">CLOSED</span>
            </div>
            <p class="text-gray-300 text-sm mb-4 line-clamp-2" th:text="${store.description()}">Description</p>
            <div class="space-y-2 text-sm">
                <div class="flex items-center justify-between text-gray-400">
                    <span><i class="fas fa-clock mr-2 text-cyber-blue"></i><span th:text="${store.estimatedDeliveryTimeMinutes()}">30</span> min</span>
                    <span><i class="fas fa-euro-sign mr-2 text-neon-pink"></i>Min â‚¬<span th:text="${store.minimumOrderAmount()}">10</span></span>
                </div>
                <div class="flex items-center text-gray-400">
                    <i class="fas fa-map-marker-alt mr-2 text-ai-orange"></i>
                    <span th:text="${store.area()}">Area</span>
                </div>
                <div class="flex gap-2 mt-3">
                    <span th:if="${store.acceptsDelivery()}" class="px-2 py-1 bg-cyber-blue/20 text-cyber-blue rounded text-xs">
                        <i class="fas fa-motorcycle mr-1"></i>Delivery
                    </span>
                    <span th:if="${store.acceptsPickup()}" class="px-2 py-1 bg-quantum/20 text-quantum rounded text-xs">
                        <i class="fas fa-shopping-bag mr-1"></i>Pickup
                    </span>
                </div>
            </div>
        </a>
    </div>
</div>
</body>
</html>